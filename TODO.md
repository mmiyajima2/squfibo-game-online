Task
----

# [x] ã‚«ãƒ¼ãƒ‰ã‚’é…ç½®ã™ã‚‹ã€ã‚¿ãƒ¼ãƒ³ã‚’çµ‚äº†ã™ã‚‹ã€ã¾ã§ã®å®Ÿè£…ã‚’ã—ã¦ã»ã—ã„
- âœ… åˆæ‰‹æœ­ãŒé…ä»˜ã•ã‚Œã‚‹ã¨ã“ã‚ã¾ã§ã¯ã§ããŸ
- âœ… å…ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚«ãƒ¼ãƒ‰ã‚’ä»»æ„ã®ã‚¹ãƒ­ãƒƒãƒˆã«é…ç½®ã—ã¦
- âœ… ã‚¿ãƒ¼ãƒ³ã‚’çµ‚äº†ã—ãŸã‚‰
- âœ… ç›¸æ‰‹æ–¹ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã¿ã¦ã„ã‚‹ãƒœãƒ¼ãƒ‰ã«ã‚‚ãã‚ŒãŒåæ˜ ã•ã‚Œã‚‹ã“ã¨

## å®Ÿè£…å†…å®¹

### 1. useOnlineGameãƒ•ãƒƒã‚¯ã®æ‹¡å¼µ
**ãƒ•ã‚¡ã‚¤ãƒ«**: `client/src/hooks/useOnlineGame.ts`

**è¿½åŠ ã—ãŸSocket.ioé€ä¿¡ãƒ¡ã‚½ãƒƒãƒ‰**:
- `claimComboToServer(cardId, position, comboPositions)`: å½¹ç”³å‘Šã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
- `endTurnToServer(cardId, position)`: ã‚¿ãƒ¼ãƒ³çµ‚äº†ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
- `removeCardToServer(position)`: ã‚«ãƒ¼ãƒ‰é™¤å»ã‚’ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡

**è¿½åŠ ã—ãŸSocket.ioãƒªã‚¹ãƒŠãƒ¼**:
- `gameStateUpdate`: ã‚²ãƒ¼ãƒ çŠ¶æ…‹æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆç›¸æ‰‹ã®æ“ä½œã‚’è‡ªå‹•çš„ã«åæ˜ ï¼‰
- `turnChanged`: ã‚¿ãƒ¼ãƒ³åˆ‡ã‚Šæ›¿ãˆã‚¤ãƒ™ãƒ³ãƒˆ
- `turnEnded`: ã‚¿ãƒ¼ãƒ³çµ‚äº†ã‚¤ãƒ™ãƒ³ãƒˆ
- `comboResolved`: å½¹è§£æ±ºã‚¤ãƒ™ãƒ³ãƒˆ
- `cardRemoved`: ã‚«ãƒ¼ãƒ‰é™¤å»ã‚¤ãƒ™ãƒ³ãƒˆ

**å®Ÿè£…è©³ç´°**:
- å„ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡æ™‚ã«ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã£ãŸã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’`initFromServer()`ã§åæ˜ 
- ã‚³ãƒ¡ãƒ³ã‚¿ãƒªãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è‡ªå‹•çš„ã«è¿½åŠ ï¼ˆè‡ªåˆ†/ç›¸æ‰‹ã®æ“ä½œã‚’åŒºåˆ¥ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨UIãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

### 2. GameContainerã®ä¿®æ­£
**ãƒ•ã‚¡ã‚¤ãƒ«**: `client/src/components/Game/GameContainer.tsx`

**å¤‰æ›´å†…å®¹**:
- Props ã«`claimComboToServer`, `endTurnToServer`, `removeCardToServer`ã‚’è¿½åŠ 
- `handleEndTurn()`: ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰æ™‚ã«ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
- `handleClaimCombo()`: ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰æ™‚ã«ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡

**å‹•ä½œ**:
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰: ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã®ã¿æ›´æ–°ï¼ˆå¾“æ¥é€šã‚Šï¼‰
- ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰: Socket.ioã§ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡ã—ã€`gameStateUpdate`ã‚¤ãƒ™ãƒ³ãƒˆã§çŠ¶æ…‹ã‚’åŒæœŸ

### 3. Game.tsxã®ä¿®æ­£
**ãƒ•ã‚¡ã‚¤ãƒ«**: `client/src/pages/Game.tsx`

**å¤‰æ›´å†…å®¹**:
- `GameContainer`ã«`useOnlineGame`ã®Socket.ioé€ä¿¡ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¸¡ã™
- `claimComboToServer`, `endTurnToServer`, `removeCardToServer`ã‚’propsã¨ã—ã¦æ¸¡ã™

### 4. å‹•ä½œãƒ•ãƒ­ãƒ¼

#### ã‚«ãƒ¼ãƒ‰é…ç½® â†’ ã‚¿ãƒ¼ãƒ³çµ‚äº†
```
1. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ‰‹æœ­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠ
   â†“
2. ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“ handleCellClick()
3. ã‚«ãƒ¼ãƒ‰ã‚’é…ç½®ï¼ˆæ¥½è¦³çš„æ›´æ–°ã§ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã‚’æ›´æ–°ï¼‰
   â†“
4. ã€Œã‚¿ãƒ¼ãƒ³çµ‚äº†ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“ handleEndTurn()
5. endTurnToServer()ã§ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
   â†“ Socket.io: endTurn ã‚¤ãƒ™ãƒ³ãƒˆ
6. ã‚µãƒ¼ãƒãƒ¼ãŒã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’æ›´æ–°
   â†“ Socket.io: gameStateUpdate ã‚¤ãƒ™ãƒ³ãƒˆ
7. ä¸¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæœ€æ–°ã®ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’å—ä¿¡
   â†“ initFromServer()
8. ç›¸æ‰‹å´ã®ãƒœãƒ¼ãƒ‰ã«ã‚‚ã‚«ãƒ¼ãƒ‰é…ç½®ãŒåæ˜ ã•ã‚Œã‚‹
```

#### ã‚«ãƒ¼ãƒ‰é…ç½® â†’ å½¹ç”³å‘Š
```
1. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ‰‹æœ­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠ
   â†“
2. ãƒœãƒ¼ãƒ‰ä¸Šã®ãƒã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“ handleCellClick()
3. ã‚«ãƒ¼ãƒ‰ã‚’é…ç½®ï¼ˆæ¥½è¦³çš„æ›´æ–°ï¼‰
   â†“
4. ãƒœãƒ¼ãƒ‰ä¸Šã®å½¹ã‚’æ§‹æˆã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠ
   â†“
5. ã€Œå½¹ã‚’ç”³å‘Šã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
   â†“ handleClaimCombo()
6. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§å½¹ã®æ¤œè¨¼
   â†“ ComboDetector.checkCombo()
7. claimComboToServer()ã§ã‚µãƒ¼ãƒãƒ¼ã«é€ä¿¡
   â†“ Socket.io: claimCombo ã‚¤ãƒ™ãƒ³ãƒˆ
8. ã‚µãƒ¼ãƒãƒ¼ãŒå½¹ã‚’æ¤œè¨¼ã—ã€ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’æ›´æ–°
   â†“ Socket.io: comboResolved ã‚¤ãƒ™ãƒ³ãƒˆ
   â†“ Socket.io: gameStateUpdate ã‚¤ãƒ™ãƒ³ãƒˆ
9. ä¸¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæœ€æ–°ã®ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’å—ä¿¡
   â†“ initFromServer()
10. ç›¸æ‰‹å´ã«ã‚‚å½¹ã®æˆç«‹ãŒåæ˜ ã•ã‚Œã‚‹ï¼ˆæ˜Ÿã®ç²å¾—ã€ã‚«ãƒ¼ãƒ‰ã®ãƒ‰ãƒ­ãƒ¼ï¼‰
```

### 5. æ¥½è¦³çš„æ›´æ–°ã¨ã‚µãƒ¼ãƒãƒ¼åŒæœŸ

**æ¥½è¦³çš„æ›´æ–°**:
- ã‚«ãƒ¼ãƒ‰é…ç½®æ™‚ã«ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã‚’ã™ãã«æ›´æ–°ï¼ˆ`placeCardFromHand()`ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã®å‘ä¸Šï¼ˆãƒ¬ã‚¹ãƒãƒ³ã‚¹é€Ÿåº¦ï¼‰

**ã‚µãƒ¼ãƒãƒ¼åŒæœŸ**:
- `endTurn`ã¾ãŸã¯`claimCombo`ã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡æ™‚ã«ã€ã‚µãƒ¼ãƒãƒ¼ãŒæ­£å¼ãªçŠ¶æ…‹ã‚’è¨ˆç®—
- `gameStateUpdate`ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡æ™‚ã«ã€ã‚µãƒ¼ãƒãƒ¼å´ã®æ­£å¼ãªçŠ¶æ…‹ã§ä¸Šæ›¸ãï¼ˆ`initFromServer()`ï¼‰
- ã‚µãƒ¼ãƒãƒ¼å´ã®æ¤œè¨¼ã«ã‚ˆã‚Šã€ä¸æ­£ãªæ“ä½œã‚’é˜²æ­¢

### 6. ã‚³ãƒ¡ãƒ³ã‚¿ãƒªãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

**è‡ªå‹•çš„ã«è¿½åŠ ã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**:
- ã‚¿ãƒ¼ãƒ³åˆ‡ã‚Šæ›¿ãˆ: ã€Œã‚ãªãŸã®ã‚¿ãƒ¼ãƒ³ã§ã™ã€/ ã€Œç›¸æ‰‹ã®ã‚¿ãƒ¼ãƒ³ã§ã™ã€
- ã‚¿ãƒ¼ãƒ³çµ‚äº†: ã€Œã‚«ãƒ¼ãƒ‰ã‚’é…ç½®ã—ã¦ã‚¿ãƒ¼ãƒ³ã‚’çµ‚äº†ã—ã¾ã—ãŸã€/ ã€Œç›¸æ‰‹ãŒã‚«ãƒ¼ãƒ‰ã‚’é…ç½®ã—ã¾ã—ãŸã€
- å½¹æˆç«‹: ã€Œå½¹ãŒæˆç«‹ã—ã¾ã—ãŸï¼ æ˜Ÿã‚’â—‹å€‹ç²å¾—ã€/ ã€Œç›¸æ‰‹ãŒå½¹ã‚’æˆç«‹ã•ã›ã¾ã—ãŸï¼ˆæ˜Ÿâ—‹å€‹ç²å¾—ï¼‰ã€
- ã‚«ãƒ¼ãƒ‰é™¤å»: ã€Œã‚«ãƒ¼ãƒ‰ã‚’é™¤å»ã—ã¾ã—ãŸã€/ ã€Œç›¸æ‰‹ãŒã‚«ãƒ¼ãƒ‰ã‚’é™¤å»ã—ã¾ã—ãŸã€

### 7. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®æ¤œè¨¼**:
- 1ã‚¿ãƒ¼ãƒ³ã«1æšã®ã¿é…ç½®å¯èƒ½
- ã‚«ãƒ¼ãƒ‰ã‚’é…ç½®ã—ã¦ã‹ã‚‰ã‚¿ãƒ¼ãƒ³çµ‚äº†
- å½¹ã®æ¤œè¨¼ï¼ˆComboDetectorï¼‰
- ä»Šã®ã‚¿ãƒ¼ãƒ³ã§é…ç½®ã—ãŸã‚«ãƒ¼ãƒ‰ãŒå½¹ã«å«ã¾ã‚Œã¦ã„ã‚‹

**ã‚µãƒ¼ãƒãƒ¼å´ã®æ¤œè¨¼**:
- å…¨ã¦ã®ãƒ«ãƒ¼ãƒ«ã‚’å†æ¤œè¨¼ï¼ˆäºŒé‡æ¤œè¨¼ï¼‰
- ä¸æ­£ãªæ“ä½œã‚’ã‚¨ãƒ©ãƒ¼ã§è¿”ã™
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’UIã«è¡¨ç¤º

### 8. ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª

1. ãƒ›ã‚¹ãƒˆãŒéƒ¨å±‹ã‚’ä½œæˆã€ã‚²ã‚¹ãƒˆãŒå‚åŠ 
2. ä¸¡æ–¹ãŒã€Œæº–å‚™å®Œäº†ã€ã‚’æŠ¼ã™
3. ã‚²ãƒ¼ãƒ ãŒé–‹å§‹ã•ã‚Œã€æ‰‹æœ­ãŒé…ã‚‰ã‚Œã‚‹
4. å…ˆæ”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ‰‹æœ­ã‹ã‚‰ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ãƒœãƒ¼ãƒ‰ã«é…ç½®
5. ã€Œã‚¿ãƒ¼ãƒ³çµ‚äº†ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™
6. å¾Œæ”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å´ã®ãƒœãƒ¼ãƒ‰ã«ã‚‚ã‚«ãƒ¼ãƒ‰é…ç½®ãŒåæ˜ ã•ã‚Œã‚‹
7. å¾Œæ”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚«ãƒ¼ãƒ‰ã‚’é…ç½®
8. å½¹ã‚’æ§‹æˆã™ã‚‹ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠã—ã¦ã€Œå½¹ã‚’ç”³å‘Šã€
9. å…ˆæ”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å´ã«ã‚‚å½¹ã®æˆç«‹ãŒåæ˜ ã•ã‚Œã‚‹ï¼ˆæ˜Ÿã®ç²å¾—ã€ã‚«ãƒ¼ãƒ‰ã®ãƒ‰ãƒ­ãƒ¼ï¼‰
10. ã‚¿ãƒ¼ãƒ³ãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã€ã‚²ãƒ¼ãƒ ãŒç¶™ç¶š

### 9. ä»Šå¾Œã®èª²é¡Œ

- [ ] ç›¤é¢ãŒæº€æ¯ã®æ™‚ã®ã‚«ãƒ¼ãƒ‰é™¤å»å‡¦ç†ï¼ˆ`removeCard`ã‚¤ãƒ™ãƒ³ãƒˆï¼‰ã®å®Ÿè£…
- [ ] åˆ‡æ–­ãƒ»å†æ¥ç¶šæ™‚ã®å‡¦ç†
- [ ] ã‚²ãƒ¼ãƒ çµ‚äº†æ™‚ã®å‡¦ç†ï¼ˆå‹è€…ã®æ±ºå®šã€çµæœã®è¡¨ç¤ºï¼‰
- [ ] ã‚¨ãƒ©ãƒ¼æ™‚ã®ãƒªãƒˆãƒ©ã‚¤å‡¦ç†
- [ ] ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºï¼ˆã‚µãƒ¼ãƒãƒ¼å¿œç­”å¾…ã¡æ™‚ï¼‰

# [x] èª¿æŸ»ä¾é ¼: å½¹ã‚’ç”³å‘Šã—ãŸã¨ãã€serverå´ã§å½¹ã®æˆç«‹ã‚’åˆ¤å®šã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚ã‚‹ã‹ç¢ºèªã—ã¦ã»ã—ã„
- åˆã‚ã›ã¦ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«ã‚‚åŒæ§˜ã®å‡¦ç†ãŒã‚ã‚‹ã‹ã€ç¢ºèªã—ã¦ã»ã—ã„
- èª¿æŸ»çµæœã¯ã“ã®è¦‹å‡ºã—ã®ã‚µãƒ–é …ç›®ã«è¨˜è¼‰ã—ã¦ã»ã—ã„

## èª¿æŸ»çµæœ

### âœ… ã‚µãƒ¼ãƒãƒ¼å´ã®å½¹åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
**å®Ÿè£…å ´æ‰€**: `server/src/services/GameService.ts:310-371`

**ãƒ¡ã‚½ãƒƒãƒ‰**: `GameService.validateCombo(board, positions, placedPosition)`

**å®Ÿè£…å†…å®¹**:
```typescript
static validateCombo(
  board: BoardStateDTO,
  positions: PositionDTO[],
  placedPosition: PositionDTO
): ComboDTO | null
```

**åˆ¤å®šå‡¦ç†**:
1. **åŸºæœ¬ãƒã‚§ãƒƒã‚¯**: 3æšã®ã‚«ãƒ¼ãƒ‰ã§ã‚ã‚‹ã‹ï¼ˆ`positions.length === 3`ï¼‰
2. **é…ç½®ã‚«ãƒ¼ãƒ‰ç¢ºèª**: ä»Šå›é…ç½®ã—ãŸã‚«ãƒ¼ãƒ‰ãŒå½¹ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹
3. **ã‚«ãƒ¼ãƒ‰å­˜åœ¨ç¢ºèª**: æŒ‡å®šã•ã‚ŒãŸä½ç½®ã«å…¨ã¦ã®ã‚«ãƒ¼ãƒ‰ãŒå­˜åœ¨ã™ã‚‹ã‹
4. **è‰²ã®ä¸€è‡´**: 3æšã®ã‚«ãƒ¼ãƒ‰ãŒå…¨ã¦åŒã˜è‰²ã‹
5. **éš£æ¥æ€§ãƒã‚§ãƒƒã‚¯**: ã‚«ãƒ¼ãƒ‰ãŒç¸¦æ¨ªã«é€£ãªã£ã¦ã„ã‚‹ã‹ï¼ˆLå­—ã€ç¸¦ä¸€åˆ—ã€æ¨ªä¸€åˆ—ï¼‰
6. **å½¹ã‚¿ã‚¤ãƒ—åˆ¤å®š**:
   - å¤§å½¹: `1-4-16` (THREE_CARDS)
   - å°å½¹: åŒã˜æ•°å­—3æš (TRIPLE_MATCH)

**å‘¼ã³å‡ºã—ç®‡æ‰€**: `server/src/socket/index.ts:817`ï¼ˆ`handleClaimCombo`é–¢æ•°å†…ï¼‰

**ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**:
```typescript
// server/src/socket/index.ts:823-831
if (!combo) {
  const error: ErrorPayload = {
    code: 'INVALID_COMBO',
    message: 'å½¹ãŒæˆç«‹ã—ã¦ã„ã¾ã›ã‚“',
  };
  callback?.(error);
  socket.emit('error', error);
  return;
}
```

---

### âœ… ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®å½¹åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯
**å®Ÿè£…å ´æ‰€**: `client/src/domain/services/ComboDetector.ts:136-169`

**ãƒ¡ã‚½ãƒƒãƒ‰**: `ComboDetector.checkCombo(cards, positions)`

**å®Ÿè£…å†…å®¹**:
```typescript
checkCombo(cards: Card[], positions: Position[]): ComboType | null
```

**åˆ¤å®šå‡¦ç†**:
1. **åŸºæœ¬ãƒã‚§ãƒƒã‚¯**: ã‚«ãƒ¼ãƒ‰ã¨ä½ç½®ã®æ•°ãŒä¸€è‡´ã—ã¦ã„ã‚‹ã‹
2. **ç©ºãƒã‚§ãƒƒã‚¯**: ã‚«ãƒ¼ãƒ‰ãŒç©ºã§ãªã„ã‹
3. **è‰²ã®ä¸€è‡´**: å…¨ã¦ã®ã‚«ãƒ¼ãƒ‰ãŒåŒã˜è‰²ã‹
4. **3æšå½¹ã®å ´åˆ**:
   - éš£æ¥æ€§ãƒã‚§ãƒƒã‚¯: ç¸¦3ã¤ã€æ¨ª3ã¤ã€ã¾ãŸã¯Lå­—å‹
   - å¤§å½¹: `1-4-16` (THREE_CARDS)
   - å°å½¹: åŒã˜æ•°å­—3æš (TRIPLE_MATCH)

**å‘¼ã³å‡ºã—ç®‡æ‰€**: `client/src/components/Game/GameContainer.tsx:376`ï¼ˆ`handleClaimCombo`é–¢æ•°å†…ï¼‰

**UIãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**:
```typescript
// client/src/components/Game/GameContainer.tsx:378-383
if (verifiedComboType === null) {
  showError('ãŠã—ã„ï¼é¸æŠã—ãŸã‚«ãƒ¼ãƒ‰ã¯å½¹ã§ã¯ã‚ã‚Šã¾ã›ã‚“');
  clearBoardCardSelection();
  return;
}
```

---

### ğŸ” ã‚µãƒ¼ãƒãƒ¼å´ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®é•ã„

| é …ç›® | ã‚µãƒ¼ãƒãƒ¼å´ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ |
|------|-----------|--------------|
| **åˆ¤å®šã‚¿ã‚¤ãƒŸãƒ³ã‚°** | å½¹ç”³å‘Šæ™‚ï¼ˆ`claimCombo`ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡æ™‚ï¼‰ | UIä¸Šã§å½¹ã‚’é¸æŠãƒ»ç”³å‘Šæ™‚ |
| **å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿** | `board`, `positions`, `placedPosition` | `cards`, `positions` |
| **é…ç½®ã‚«ãƒ¼ãƒ‰ãƒã‚§ãƒƒã‚¯** | âœ… ã‚ã‚Šï¼ˆä»Šå›é…ç½®ã—ãŸã‚«ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ï¼‰ | âŒ ãªã—ï¼ˆGameContainer.tsxã§åˆ¥é€”ãƒã‚§ãƒƒã‚¯ï¼‰ |
| **éš£æ¥æ€§ãƒã‚§ãƒƒã‚¯** | âœ… `areCardsAdjacent()` ãƒ¡ã‚½ãƒƒãƒ‰ | âœ… `areAdjacentThreeCards()` ãƒ¡ã‚½ãƒƒãƒ‰ |
| **ã‚¨ãƒ©ãƒ¼å‡¦ç†** | Socket.ioã‚¤ãƒ™ãƒ³ãƒˆã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«é€šçŸ¥ | UIã§ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º |
| **è¿”ã‚Šå€¤** | `ComboDTO \| null` | `ComboType \| null` |

---

### ğŸ“Š å½¹åˆ¤å®šã®æµã‚Œï¼ˆã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ï¼‰

```
1. ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§å½¹ã‚’é¸æŠ
   â†“
2. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§äº‹å‰æ¤œè¨¼ï¼ˆComboDetector.checkComboï¼‰
   â†“ âœ… æ¤œè¨¼æˆåŠŸ
3. ã‚µãƒ¼ãƒãƒ¼ã« claimCombo ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡
   â†“
4. ã‚µãƒ¼ãƒãƒ¼å´ã§å†æ¤œè¨¼ï¼ˆGameService.validateComboï¼‰
   â†“ âœ… æ¤œè¨¼æˆåŠŸ
5. å½¹ã®è§£æ±ºå‡¦ç†ï¼ˆæ˜Ÿã®ä»˜ä¸ã€ã‚«ãƒ¼ãƒ‰ã®é™¤å»ã€ã‚«ãƒ¼ãƒ‰ãƒ‰ãƒ­ãƒ¼ï¼‰
   â†“
6. ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã« gameState æ›´æ–°ã‚’é€ä¿¡
```

---

### ğŸ’¡ çµè«–

- âœ… **ã‚µãƒ¼ãƒãƒ¼å´ã«ã¯å½¹ã®æˆç«‹ã‚’åˆ¤å®šã™ã‚‹ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚ã‚Šã¾ã™**
  - `GameService.validateCombo()` ã§å³æ ¼ã«æ¤œè¨¼
  - ä¸æ­£ãªå½¹ç”³å‘Šã‚’é˜²ãã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã¨ã—ã¦æ©Ÿèƒ½

- âœ… **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«ã‚‚åŒæ§˜ã®å‡¦ç†ãŒã‚ã‚Šã¾ã™**
  - `ComboDetector.checkCombo()` ã§UIä¸Šã®äº‹å‰æ¤œè¨¼
  - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å‘ä¸Šã®ãŸã‚ã®å³åº§ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯

- ğŸ”’ **äºŒé‡æ¤œè¨¼ã«ã‚ˆã‚‹å®‰å…¨æ€§**
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´: ä¸æ­£ãªæ“ä½œã‚’é˜²ãã€UXå‘ä¸Š
  - ã‚µãƒ¼ãƒãƒ¼å´: æœ€çµ‚çš„ãªæ­£å½“æ€§ã‚’ä¿è¨¼ï¼ˆä¸æ­£é˜²æ­¢ï¼‰

- âš ï¸ **æ³¨æ„ç‚¹**
  - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®æ¤œè¨¼ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦ã‚‚ã€ã‚µãƒ¼ãƒãƒ¼å´ã§å¿…ãšå†æ¤œè¨¼ã•ã‚Œã‚‹ãŸã‚ã€ãƒãƒ¼ãƒˆå¯¾ç­–ã¯ååˆ†
  - ä¸¡æ–¹ã®ãƒ­ã‚¸ãƒƒã‚¯ã¯ä¼¼ã¦ã„ã‚‹ãŒã€å®Œå…¨ã«ä¸€è‡´ã—ã¦ã„ã‚‹ã‚ã‘ã§ã¯ãªã„ï¼ˆã‚µãƒ¼ãƒãƒ¼å´ãŒã‚ˆã‚Šå³æ ¼ï¼‰

# [x] clientå´ã€ã‚²ã‚¹ãƒˆå´ã«ã¤ã„ã¦ã€ãƒ›ã‚¹ãƒˆå´ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åå‰ãŒã§ã¦ãªã„
- ãƒ›ã‚¹ãƒˆå´ã«ã¯ã€ã‚²ã‚¹ãƒˆå´ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼åãŒã§ã¦ã„ã‚‹
- ã‚²ã‚¹ãƒˆå´ã«ã€ãƒ›ã‚¹ãƒˆãŒæ¸¡ã™URLã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å«ã‚ã‚‹ã‹ã€éƒ¨å±‹ã«ã¯ã„ã£ãŸæ™‚ç‚¹ã€ã‚ã‚‹ã„ã¯æº–å‚™å®Œäº†æ™‚ç‚¹ã§ãƒ›ã‚¹ãƒˆå´ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®åå‰ã‚’ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã‚‚ã‚‰ã†ã‹ã€APIã®è²¬å‹™ã€ç–çµåˆãªæ§‹æˆã€ã‚’è¦³ç‚¹ã«ã—ã¦åŸå‘³ã—ã¦ã»ã—ã„

## å®Ÿè£…å†…å®¹ï¼ˆä¿®æ­£ç‰ˆï¼‰
- **æ¡ç”¨ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**: Game.tsxã®`handleJoinRoomSuccess`ã§`hostPlayerName`ã‚’å–å¾—ã—ã¦ä¿å­˜
- **å®Ÿè£…ç®‡æ‰€**:
  - `client/src/pages/Game.tsx:81` - `hostPlayerName`ã®stateè¿½åŠ 
  - `client/src/pages/Game.tsx:150-154` - `handleJoinRoomSuccess`ã§`hostPlayerName`ã‚’ä¿å­˜
  - `client/src/pages/Game.tsx:108-112` - `opponentPlayerName`ã®è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯æ›´æ–°
- **å®Ÿè£…è©³ç´°**:
  1. `hostPlayerName`ã®stateã‚’è¿½åŠ 
  2. `handleJoinRoomSuccess`ã§`data.roomInfo.hostPlayerName`ã‚’ä¿å­˜
  3. ã‚²ã‚¹ãƒˆå´ã®å ´åˆã€`hostPlayerName`ã‚’`opponentPlayerName`ã¨ã—ã¦ä½¿ç”¨
  4. ãƒ›ã‚¹ãƒˆå´ã®å ´åˆã€`useOnlineGame`ã®`opponentPlayerName`ï¼ˆplayerJoinedã‚¤ãƒ™ãƒ³ãƒˆã‹ã‚‰å–å¾—ï¼‰ã‚’ä½¿ç”¨
- **ç†ç”±**:
  - `handleJoinRoomSuccess`ãŒå‘¼ã°ã‚ŒãŸæ™‚ç‚¹ã§ã¯ã€ã¾ã `guestPlayerId`ãŒæœªè¨­å®šã®ãŸã‚`isOnlineMode`ãŒ`false`
  - ãã®ãŸã‚ã€`useOnlineGame`ã®`enabled`ãŒ`false`ã¨ãªã‚Šã€`roomJoined`ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ãŒç™»éŒ²ã•ã‚Œãªã„
  - ã‚¿ã‚¤ãƒŸãƒ³ã‚°å•é¡Œã‚’å›é¿ã™ã‚‹ãŸã‚ã€`handleJoinRoomSuccess`ã§ç›´æ¥`hostPlayerName`ã‚’å–å¾—ã—ã¦ä¿å­˜
- **ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•**:
  - Socket.ioã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ãŒ`useOnlineGame`ã¨`Game.tsx`ã«åˆ†æ•£ï¼ˆç–çµåˆã®åŸå‰‡ã«è‹¥å¹²åã™ã‚‹ï¼‰
  - ã—ã‹ã—ã€å®Ÿè£…ãŒç¢ºå®Ÿã«å‹•ä½œã—ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°å•é¡Œã‚’å›é¿ã§ãã‚‹

# [x] clientå´ã€ã€Œæº–å‚™å®Œäº†ã€ãƒœã‚¿ãƒ³ã®å®Ÿè£…ã‚’ã—ã¦ã»ã—ã„-2
- ãƒ›ã‚¹ãƒˆå´ã€ã‚²ã‚¹ãƒˆå´ã€é †ç•ªå•ã‚ãšã©ã¡ã‚‰ã‚‚æº–å‚™å®Œäº†ã‚’é€ã‚‹
- ãƒ›ã‚¹ãƒˆä¸‹å´æ‰‹æœ­ã€ã‚²ã‚¹ãƒˆã¯ä¸Šå´æ‰‹æœ­ã§å›ºå®šã¨ã™ã‚‹
- ä¸¡æ–¹æº–å‚™å®Œäº†ã®æœã¨ã—ã¦ã€ãƒ›ã‚¹ãƒˆå´ã«ã‚‚ã‚²ã‚¹ãƒˆå´ã«ã‚‚æ‰‹æœ­ãŒé…ã‚‰ã‚Œã¦ã„ã‚‹
- ã¾ãŸã€ãƒ‡ãƒƒã‚­ã®æ®‹æ•°ã‚‚ã‚µãƒ¼ãƒã‹ã‚‰å–å¾—ã—ã¦æ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- ã¾ãŸã€æ˜Ÿã®æ•°ã‚‚ã‚µãƒ¼ãƒã‹ã‚‰å–å¾—ã—ã¦æ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- ã©ã¡ã‚‰ãŒã€å…ˆæ–¹ã‹ã‚‚ã‚µãƒ¼ãƒã‹ã‚‰å–å¾—ã—ã¦æ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- ä¸€ç•ªä¸‹ã®ãƒ­ã‚°ã‚¨ãƒªã‚¢ã«ã€ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã€ã®ãƒ­ã‚°ãŒã§ã‚‹
- ãƒ“ã‚¸ãƒãƒ­ã‚¸ãƒƒã‚¯ã¯ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯ã«ã‚ˆã›ã‚‹ã‚ˆã†ã«ã™ã‚‹

# [x] clientå´ã€ã€Œæº–å‚™å®Œäº†ã€ãƒœã‚¿ãƒ³ã®å®Ÿè£…ã‚’ã—ã¦ã»ã—ã„
- ãƒ›ã‚¹ãƒˆå´ã€ã‚²ã‚¹ãƒˆå´ã€é †ç•ªå•ã‚ãšã©ã¡ã‚‰ã‚‚æº–å‚™å®Œäº†ã‚’é€ã‚‹
- ä¸¡æ–¹æº–å‚™å®Œäº†ã®æœã¨ã—ã¦ã€ãƒ›ã‚¹ãƒˆå´ã«ã‚‚ã‚²ã‚¹ãƒˆå´ã«ã‚‚æ‰‹æœ­ãŒé…ã‚‰ã‚Œã¦ã„ã‚‹
- ã¾ãŸã€ãƒ‡ãƒƒã‚­ã®æ®‹æ•°ã‚‚ã‚µãƒ¼ãƒã‹ã‚‰å–å¾—ã—ã¦æ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- ã¾ãŸã€æ˜Ÿã®æ•°ã‚‚ã‚µãƒ¼ãƒã‹ã‚‰å–å¾—ã—ã¦æ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- ã©ã¡ã‚‰ãŒã€å…ˆæ–¹ã‹ã‚‚ã‚µãƒ¼ãƒã‹ã‚‰å–å¾—ã—ã¦æ›´æ–°ã•ã‚Œã¦ã„ã‚‹
- ä¸€ç•ªä¸‹ã®ãƒ­ã‚°ã‚¨ãƒªã‚¢ã«ã€ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã€ã®ãƒ­ã‚°ãŒã§ã‚‹
- ä»Šã®Reactã®ã‚³ãƒ¼ãƒ‰ã‚’å‰æã¨ã—ã¦ã€ã¾ãšã¯ã©ã„ã†è¨­è¨ˆã«ã™ã‚‹ã‹ã€APIã®å‘¼ã³å‡ºã—ç®‡æ‰€ã€ãƒãƒªã‚·ãƒ¼ã‚’ã¾ãšã¾ã¨ã‚ã¦ã»ã—ã„ï¼ˆå®Ÿè£…ã¯ãã®å¾Œï¼‰
  
## Claudeã®æ„è¦‹

### ç¾åœ¨ã®å®Ÿè£…çŠ¶æ³

#### âœ… ã‚µãƒ¼ãƒãƒ¼å´ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰
- `server/src/socket/index.ts:299-419`: `handleReady`é–¢æ•°ãŒå®Ÿè£…æ¸ˆã¿
- `ReadyPayload`ã§`{ roomId: string, playerId: string }`ã‚’å—ã‘å–ã‚‹
- ä¸¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæº–å‚™å®Œäº†ã™ã‚‹ã¨ï¼š
  - ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’åˆæœŸåŒ–ï¼ˆ`GameService.createInitialGameState`ï¼‰
  - å„ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«å€‹åˆ¥ã®`gameStart`ã‚¤ãƒ™ãƒ³ãƒˆã‚’é€ä¿¡
  - `GameStartPayload`ã«ã¯ä»¥ä¸‹ãŒå«ã¾ã‚Œã‚‹ï¼š
    - `gameState`: ãƒã‚¹ã‚¯ã•ã‚ŒãŸã‚²ãƒ¼ãƒ çŠ¶æ…‹ï¼ˆç›¸æ‰‹ã®æ‰‹æœ­ãŒéš ã•ã‚Œã¦ã„ã‚‹ï¼‰
    - `yourPlayerId`: è‡ªåˆ†ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ID
    - `yourPlayerIndex`: è‡ªåˆ†ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ0ã¾ãŸã¯1ï¼‰

#### âš ï¸ ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ï¼ˆéƒ¨åˆ†å®Ÿè£…ï¼‰
1. **client/src/pages/Game.tsx:168-182**:
   - âŒ `handleReady`ã§`playerId`ã‚’é€ä¿¡ã—ã¦ã„ãªã„ï¼ˆç¾åœ¨ã¯`roomId`ã®ã¿ï¼‰
   - âŒ `handleGameStart`ï¼ˆ153-157è¡Œï¼‰ã§TODOã‚³ãƒ¡ãƒ³ãƒˆãŒã‚ã‚Šã€ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã®åˆæœŸåŒ–ãŒæœªå®Ÿè£…
   - âœ… `socket.on('gameStart', handleGameStart)`ã§ãƒªã‚¹ãƒŠãƒ¼ã¯ç™»éŒ²æ¸ˆã¿

2. **client/src/components/Game/GameContainer.tsx**:
   - âœ… æº–å‚™å®Œäº†ãƒœã‚¿ãƒ³ã®UIã¯å®Ÿè£…æ¸ˆã¿ï¼ˆ442-446è¡Œã€509-519è¡Œã€589-597è¡Œï¼‰
   - âœ… `useGameState`ãƒ•ãƒƒã‚¯ã§ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’ç®¡ç†

3. **client/src/hooks/useGameState.ts**:
   - âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã‚²ãƒ¼ãƒ ç”¨ã®çŠ¶æ…‹ç®¡ç†ã¯å®Œæˆ
   - âŒ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ã§ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã£ãŸçŠ¶æ…‹ã‚’åæ˜ ã™ã‚‹æ©Ÿèƒ½ãŒãªã„
   - `RESET_GAME`ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯æ–°è¦ã‚²ãƒ¼ãƒ ä½œæˆã®ã¿ã§ã€æ—¢å­˜ã®ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‹ã‚‰ã®åˆæœŸåŒ–ã¯ã§ããªã„

---

### è¨­è¨ˆæ–¹é‡

#### ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ: useGameStateã‚’æ‹¡å¼µã™ã‚‹ï¼ˆæ¨å¥¨ï¼‰
æ—¢å­˜ã®`useGameState`ã«æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã¦ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã¨ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§åŒã˜ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚

**ç†ç”±**:
- ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡ã‚’é¿ã‘ã‚‹
- æ—¢å­˜ã®ã‚³ãƒ¼ãƒ‰ã¸ã®å½±éŸ¿ã‚’æœ€å°é™ã«ã§ãã‚‹
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ»ã‚ªãƒ³ãƒ©ã‚¤ãƒ³é–“ã§ã®åˆ‡ã‚Šæ›¿ãˆãŒã‚¹ãƒ ãƒ¼ã‚º

---

### APIå‘¼ã³å‡ºã—ãƒãƒªã‚·ãƒ¼

#### 1. æº–å‚™å®Œäº†ã®é€ä¿¡
**å ´æ‰€**: `client/src/pages/Game.tsx:168-182`ï¼ˆ`handleReady`é–¢æ•°ï¼‰

**ä¿®æ­£å†…å®¹**:
```typescript
const handleReady = () => {
  if (!roomIdParam || !actualPlayerId) return

  console.log('æº–å‚™å®Œäº†ã‚’é€ä¿¡:', { roomId: roomIdParam, playerId: actualPlayerId })
  socket.emit('ready', { roomId: roomIdParam, playerId: actualPlayerId }, (response: any) => {
    if (response?.success || response?.gameState) {
      // gameStateãŒè¿”ã£ã¦ããŸå ´åˆã¯ä¸¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæº–å‚™å®Œäº†ã—ã¦ã„ã‚‹
      setIsReady(true)
      setIsWaitingForGameStart(response?.gameState ? false : true)
      console.log('æº–å‚™å®Œäº†ã—ã¾ã—ãŸ')
    } else {
      console.error('æº–å‚™å®Œäº†ã«å¤±æ•—:', response?.error)
    }
  })
}
```

**ãƒãƒªã‚·ãƒ¼**:
- `roomId`ã¨`playerId`ã®ä¸¡æ–¹ã‚’å¿…é ˆã§é€ä¿¡
- callbackã§æˆåŠŸ/å¤±æ•—ã‚’ç¢ºèª
- æˆåŠŸæ™‚ã¯`isReady: true`ã«ã™ã‚‹
- ä¸¡ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæº–å‚™å®Œäº†ã—ã¦ã„ã‚‹å ´åˆã¯`gameState`ãŒè¿”ã£ã¦ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

#### 2. ã‚²ãƒ¼ãƒ é–‹å§‹ã®å—ä¿¡
**å ´æ‰€**: `client/src/pages/Game.tsx:152-157`ï¼ˆ`handleGameStart`é–¢æ•°ï¼‰

**å®Ÿè£…å†…å®¹**:
```typescript
const handleGameStart = (data: GameStartPayload) => {
  console.log('ã‚²ãƒ¼ãƒ é–‹å§‹:', data)
  setIsWaitingForGameStart(false)

  // ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã£ãŸã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«åæ˜ 
  initGameFromServer(data.gameState, data.yourPlayerIndex)

  // ã‚²ãƒ¼ãƒ é–‹å§‹ã®ãƒ­ã‚°ã‚’è¿½åŠ 
  addCommentaryMessage('ã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™')

  // å…ˆæ”»/å¾Œæ”»ã‚’è¡¨ç¤º
  const isFirstPlayer = data.yourPlayerIndex === data.gameState.currentPlayerIndex
  addCommentaryMessage(isFirstPlayer ? 'ã‚ãªãŸã®å…ˆæ”»ã§ã™' : 'ç›¸æ‰‹ã®å…ˆæ”»ã§ã™')
}
```

**ãƒãƒªã‚·ãƒ¼**:
- `GameStartPayload`ã‹ã‚‰ä»¥ä¸‹ã‚’å–å¾—ï¼š
  - `gameState`: ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã£ãŸã‚²ãƒ¼ãƒ çŠ¶æ…‹
  - `yourPlayerId`: è‡ªåˆ†ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ID
  - `yourPlayerIndex`: è‡ªåˆ†ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ0ã¾ãŸã¯1ï¼‰
- `useGameState`ã®æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã£ã¦ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’åˆæœŸåŒ–
- CommentaryAreaã«ã€Œã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã€ãƒ­ã‚°ã‚’è¿½åŠ 

#### 3. çŠ¶æ…‹ã®åæ˜ 
ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã£ãŸ`gameState`ï¼ˆ`GameStateDTO`å‹ï¼‰ã«ã¯ä»¥ä¸‹ãŒå«ã¾ã‚Œã‚‹ï¼š

```typescript
interface GameStateDTO {
  players: Array<{
    id: string
    hand: { cards: CardDTO[] }
    stars: number
  }>
  board: { cells: (CardDTO | null)[][] }
  deckCount: number
  totalStars: number
  currentPlayerIndex: 0 | 1
  gameState: GameState  // 'SETUP' | 'PLAYING' | 'FINISHED'
  lastAutoDrawnPlayerId: string | null
}
```

**åæ˜ ã™ã‚‹æƒ…å ±**:
- âœ… æ‰‹æœ­: `gameState.players[yourPlayerIndex].hand.cards`
- âœ… ãƒ‡ãƒƒã‚­æ®‹æ•°: `gameState.deckCount`
- âœ… æ˜Ÿã®æ•°: `gameState.players[0].stars`, `gameState.players[1].stars`ã€`gameState.totalStars`
- âœ… å…ˆæ”»/å¾Œæ”»: `gameState.currentPlayerIndex`ï¼ˆè‡ªåˆ†ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨æ¯”è¼ƒï¼‰
- âœ… ç›¤é¢: `gameState.board.cells`
- âœ… ãƒ­ã‚°: CommentaryAreaã«ã€Œã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã€ã‚’è¿½åŠ 

#### 4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- `socket.on('error')`ã§ã‚¨ãƒ©ãƒ¼ã‚’å—ä¿¡
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤º
- æº–å‚™å®Œäº†çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆ`isReady: false`, `isWaitingForGameStart: false`ï¼‰

---

### å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

#### Step 1: å‹å®šç¾©ã®ç¢ºèªã¨è¿½åŠ 
- ãƒ•ã‚¡ã‚¤ãƒ«: `client/src/lib/socket.ts`
- `GameStartPayload`å‹ã‚’è¿½åŠ ï¼ˆã‚µãƒ¼ãƒãƒ¼å´ã®å‹å®šç¾©ã‚’å‚è€ƒã«ï¼‰
- `@squfibo/shared`ã‹ã‚‰`GameStateDTO`ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

#### Step 2: useGameStateã®æ‹¡å¼µ
- ãƒ•ã‚¡ã‚¤ãƒ«: `client/src/hooks/useGameState.ts`
- æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³`INIT_FROM_SERVER`ã‚’è¿½åŠ 
- `GameStateDTO`ã‚’å—ã‘å–ã‚Šã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã®`Game`ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
- reducerã«ä»¥ä¸‹ã®ã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ ï¼š
  ```typescript
  case 'INIT_FROM_SERVER': {
    // GameStateDTOã‹ã‚‰Gameã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰
    const game = Game.fromServerState(action.gameState, action.yourPlayerIndex)
    return {
      game,
      version: 0,
      currentPlayerIndexSnapshot: action.gameState.currentPlayerIndex,
      hasGameStarted: true,
    }
  }
  ```

#### Step 3: Game.tsx ã®ä¿®æ­£
**3-1. handleReady ã®ä¿®æ­£**:
- `playerId`ã‚’è¿½åŠ ã—ã¦é€ä¿¡ï¼ˆ168-182è¡Œï¼‰
- `actualPlayerId`ã‚’ä½¿ç”¨

**3-2. handleGameStart ã®å®Ÿè£…**:
- ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã£ãŸ`gameState`ã‚’`useGameState`ã®æ–°ã—ã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«æ¸¡ã™ï¼ˆ152-157è¡Œï¼‰
- `isWaitingForGameStart`ã‚’`false`ã«ã™ã‚‹
- CommentaryAreaã«ãƒ­ã‚°ã‚’è¿½åŠ ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…

**3-3. CommentaryAreaçµ±åˆ**:
- `Game.tsx`ã«`useCommentary`ãƒ•ãƒƒã‚¯ã‚’è¿½åŠ 
- `addMessage`é–¢æ•°ã‚’`GameContainer`ã«æ¸¡ã™
- ã¾ãŸã¯ã€`GameContainer`ã‹ã‚‰ä¸Šä½ã«æŒã¡ä¸Šã’ã‚‹

#### Step 4: GameContainer.tsx ã®èª¿æ•´
- `onGameStart`ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¿½åŠ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯`hasGameStarted`ã‚’`props`ã‹ã‚‰å—ã‘å–ã‚‹

#### Step 5: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®å®Ÿè£…
- `socket.on('error')`ãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
- ã‚¨ãƒ©ãƒ¼æ™‚ã«æº–å‚™å®Œäº†çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ

---

### è€ƒæ…®äº‹é …

1. **GameStateDTOã‹ã‚‰Gameã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¸ã®å¤‰æ›**:
   - `Game.fromServerState`é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
   - ã¾ãŸã¯ã€reducerã§ç›´æ¥å¤‰æ›å‡¦ç†ã‚’æ›¸ã

2. **ç›¸æ‰‹ã®æ‰‹æœ­ã®ãƒã‚¹ã‚¯**:
   - ã‚µãƒ¼ãƒãƒ¼å´ã§æ—¢ã«ãƒã‚¹ã‚¯æ¸ˆã¿ï¼ˆç›¸æ‰‹ã®æ‰‹æœ­ã¯ç©ºé…åˆ—ã«ãªã£ã¦ã„ã‚‹ï¼‰
   - ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã§ã¯ç‰¹åˆ¥ãªå‡¦ç†ã¯ä¸è¦

3. **ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰ã§ã®æ“ä½œåˆ¶é™**:
   - è‡ªåˆ†ã®ã‚¿ãƒ¼ãƒ³ã§ãªã„æ™‚ã¯æ“ä½œã‚’ç„¡åŠ¹åŒ–
   - `yourPlayerIndex`ã¨`currentPlayerIndex`ã‚’æ¯”è¼ƒ

4. **åˆ‡æ–­æ™‚ã®å‡¦ç†**:
   - ç¾æ™‚ç‚¹ã§ã¯è€ƒæ…®ã—ãªã„ï¼ˆå¾Œã§å®Ÿè£…ï¼‰

5. **ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã®åŒæœŸ**:
   - ã‚²ãƒ¼ãƒ é–‹å§‹å¾Œã®å„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆã‚«ãƒ¼ãƒ‰é…ç½®ã€å½¹ç”³å‘Šãªã©ï¼‰ã®ã‚µãƒ¼ãƒãƒ¼é€£æºã¯åˆ¥ã‚¿ã‚¹ã‚¯
   - ä»Šå›ã¯ã€Œæº–å‚™å®Œäº†ã€â†’ã€Œã‚²ãƒ¼ãƒ é–‹å§‹ã€ã®å®Ÿè£…ã®ã¿

---

### ã¾ã¨ã‚

**å®Ÿè£…ã®å„ªå…ˆé †ä½**:
1. âœ… Step 1: å‹å®šç¾©ã®ç¢ºèªã¨è¿½åŠ  - **å®Œäº†**
2. âœ… Step 2: useGameStateã®æ‹¡å¼µï¼ˆ`INIT_FROM_SERVER`ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ ï¼‰ - **å®Œäº†**
3. âœ… Step 3: `useOnlineGame`ãƒ•ãƒƒã‚¯ã®ä½œæˆ - **å®Œäº†**
4. âœ… Step 4: Game.tsx ã®ä¿®æ­£ - **å®Œäº†**
5. âœ… Step 5: GameContainer.tsx ã®èª¿æ•´ - **å®Œäº†**
6. âœ… Step 6: CommentaryAreaçµ±åˆï¼ˆã‚²ãƒ¼ãƒ é–‹å§‹ãƒ­ã‚°ã®è¡¨ç¤ºï¼‰ - **å®Œäº†**
7. âœ… Step 7: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„ - **å®Œäº†**

## å®Ÿè£…å®Œäº†å†…å®¹

### 1. å‹å®šç¾©ã®è¿½åŠ 
- `client/src/lib/socket.ts`: `GameStartPayload`å‹ã‚’è¿½åŠ 
- `squfibo-shared`ã‹ã‚‰`GameStateDTO`ã‚’import

### 2. Game.tsã®æ‹¡å¼µ
- `Game.fromServerState()`é™çš„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
- `GameStateDTO`ã‹ã‚‰Gameã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ§‹ç¯‰ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…

### 3. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚¯ãƒ©ã‚¹ã®æ‹¡å¼µ
- `Player.setStars()`: æ˜Ÿã®æ•°ã‚’ç›´æ¥ã‚»ãƒƒãƒˆã§ãã‚‹ã‚ˆã†ã«
- `Hand.setCards()`: æ‰‹æœ­ã‚’ç›´æ¥ã‚»ãƒƒãƒˆã§ãã‚‹ã‚ˆã†ã«

### 4. useGameStateã®æ‹¡å¼µ
- `INIT_FROM_SERVER`ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ 
- `initFromServer()`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ 
- ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å—ã‘å–ã£ãŸ`GameStateDTO`ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã«åæ˜ å¯èƒ½ã«

### 5. useOnlineGameãƒ•ãƒƒã‚¯ã®ä½œæˆ
- Socket.ioé€šä¿¡ã¨ã‚²ãƒ¼ãƒ çŠ¶æ…‹ç®¡ç†ã‚’çµ±åˆ
- `sendReady()`: æº–å‚™å®Œäº†ã‚’é€ä¿¡
- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼: `gameStart`, `playerJoined`, `error`
- ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã‚²ãƒ¼ãƒ å›ºæœ‰ã®çŠ¶æ…‹ç®¡ç†: `isReady`, `isWaitingForGameStart`, `opponentPlayerName`, `gameStarted`

### 6. Game.tsxã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°
- `useOnlineGame`ãƒ•ãƒƒã‚¯ã‚’çµ±åˆ
- `handleReady`ã‚’`onlineGame.sendReady`ã«ç½®ãæ›ãˆ
- Socket.ioã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤ï¼ˆuseOnlineGameã§ç®¡ç†ï¼‰

### 7. GameContainer.tsxã®èª¿æ•´
- `onlineGameState` propsã‚’è¿½åŠ 
- ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã€propsã‹ã‚‰æ¸¡ã•ã‚ŒãŸgameStateã‚’ä½¿ç”¨
- ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ¢ãƒ¼ãƒ‰ã®å ´åˆã€å¾“æ¥é€šã‚Šãƒ­ãƒ¼ã‚«ãƒ«ã®useGameStateã‚’ä½¿ç”¨

### 8. CommentaryAreaçµ±åˆ
- `useOnlineGame`ã«`onAddMessage`ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¿½åŠ 
- ã‚²ãƒ¼ãƒ é–‹å§‹æ™‚ã«ã€Œã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã€ã®ãƒ­ã‚°ã‚’è¡¨ç¤º
- å…ˆæ”»/å¾Œæ”»ã®æƒ…å ±ã‚’ãƒ­ã‚°ã«è¡¨ç¤º
- `Game.tsx`ã§`useCommentary`ã‚’ä½¿ç”¨ã—ã€`useOnlineGame`ã«æ¸¡ã™
- `GameContainer.tsx`ã§`onlineCommentary`ã‚’propsã§å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«æ‹¡å¼µ

### 9. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„
- `useOnlineGame`ã«`onShowError`ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’è¿½åŠ 
- æº–å‚™å®Œäº†æ™‚ã®ã‚¨ãƒ©ãƒ¼ã‚’UIè¡¨ç¤º
- Socket.ioã‚¨ãƒ©ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆã‚’UIè¡¨ç¤º
- `Game.tsx`ã§`useUIState`ã‚’ä½¿ç”¨ã—ã€`useOnlineGame`ã«æ¸¡ã™
- `GameContainer.tsx`ã§`onlineUIState`ã‚’propsã§å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«æ‹¡å¼µ

**ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª**:
1. ãƒ›ã‚¹ãƒˆãŒéƒ¨å±‹ã‚’ä½œæˆ
2. ã‚²ã‚¹ãƒˆãŒå‚åŠ 
3. ãƒ›ã‚¹ãƒˆãŒã€Œæº–å‚™å®Œäº†ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™
4. ã‚²ã‚¹ãƒˆãŒã€Œæº–å‚™å®Œäº†ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™
5. ä¸¡æ–¹ã«æ‰‹æœ­ãŒé…ã‚‰ã‚Œã€ãƒ‡ãƒƒã‚­æ®‹æ•°ãƒ»æ˜Ÿã®æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
6. ãƒ­ã‚°ã«ã€Œã‚²ãƒ¼ãƒ ã‚’é–‹å§‹ã—ã¾ã™ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹
7. å…ˆæ”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒåˆ†ã‹ã‚‹